<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Form</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.1.0/css/v4-shims.min.css"
        integrity="sha512-p++g4gkFY8DBqLItjIfuKJPFvTPqcg2FzOns2BNaltwoCOrXMqRIOqgWqWEvuqsj/3aVdgoEo2Y7X6SomTfUPA=="
        crossorigin="anonymous" />
    <link rel="stylesheet" href="/css/all.min.css">
    <link rel="stylesheet" href="./form.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <h2>Registration Form</h2>
        </div>
        <form class="Form" id="form"> <br>
            <div class="form-control">
                <label>Username : </label>
                <input type="text" name="" id="username" placeholder="syz" autocomplete="off">
                <i class="far fa-check-circle"></i>
                <i class="fas fa-exclamation-triangle"></i>
                <small>Error message</small>
            </div> <br><br>
            <div class="form-control">
                <label>Password : </label>
                <input type="password" name="" id="password" placeholder="xxx">
                <i class="far fa-check-circle"></i>
                <i class="fas fa-exclamation-triangle"></i>
                <small>Error message</small>
            </div> <br><br>
            <div class="form-control">
                <label>Email Id : </label>
                <input type="email" name="" id="email" placeholder="syz@gmail.com" autocomplete="off">
                <i class="far fa-check-circle"></i>
                <i class="fas fa-exclamation-triangle"></i>
                <small>Error message</small>
            </div><br><br>
            <div class="form-control">
                <label>Phone No.: </label>
                <input type="number" name="" id="number" placeholder="0123456789" autocomplete="off">
                <i class="far fa-check-circle"></i>
                <i class="fas fa-exclamation-triangle"></i>
                <small>Error message</small>
            </div><br><br>
            <button type="submit" id="Btn" class="btn">submit</button>
        </form>
    </div>
    <script type="text/javascript">
        const form = document.getElementById('form');
        const username = document.getElementById('username');
        const password = document.getElementById('password');
        const email = document.getElementById('email');
        const number = document.getElementById('number');

        form.addEventListener('submit', (event) => {
            event.preventDefault();
            Validate();
        })

        const Validate = () => {
            const usernameVal = username.value.trim();
            const emailVal = email.value.trim();
            const passwordVal = password.value.trim();
            const numberVal = number.value.trim();

            // more email validate 
            const isEmail = () => {
                var atSymbol = emailVal.indexOf("@");
                if (atSymbol < 1)
                    return false;
                var dot = emailVal.lastIndexOf('.');
                if (dot <= atSymbol + 2)
                    return false;
                if (dot === emailVal.length - 1)
                    return true;

                {
                    // Instantiate an xhr object
                    const xhr = new XMLHttpRequest();

                    // Open the object
                    xhr.open('GET', 'form.txt', true);

                    // what to do when response is ready 
                    xhr.onload = function () {
                        document.write(this.responseText)
                    }

                    //send the request 
                    xhr.send();
                }
            }

            //validate username 
            if (usernameVal === "") {
                setErrormsg(username, 'username cannot be blank');
            }
            else if (usernameVal.length <= 2) {
                setErrormsg(username, 'username min 3 char');
            } else {
                setSuccessMsg(username);
            }

            // email 
            if (emailVal === "") {
                setErrormsg(email, 'emailId cannot be blank');
            }
            else if (isEmail()) {
                setErrormsg(!isEmailVal, 'email min 3 char');
            } else {
                setSuccessMsg(email);
            }

            // password 
            if (passwordVal === "") {
                setErrormsg(password, 'password cannot be blank');
            }
            else if (passwordVal.length <= 6) {
                setErrormsg(password, 'password min 6 char');
            } else {
                setSuccessMsg(password);
            }

            //number 
            if (numberVal === "") {
                setErrormsg(number, 'number cannot be blank');
            }
            else if (numberVal.length != 10) {
                setErrormsg(number, 'number should be 10 digit');
            } else {
                setSuccessMsg(number);
            }
        }

        function setErrormsg(input, errormsgs) {
            const formControl = input.parentElement;
            const small = formControl.querySelector('small');
            formControl.className = 'form-control error';
            small.innerText = errormsgs;
        }
        function setSuccessMsg(input) {
            const formControl = input.parentElement;
            formControl.className = 'form-control success';
        }


    </script>
</body>

</html>